# Request

You are tasked with implementing a Chisel3 module according to the design specification provided. The module that needs to be implemented is marked with `// TODO: Implement the module logic here` in the context provided.

Ensure your Chisel code fully implements the design specification and adheres to best practices.

# Output

Your final output should include the following sections:

- Steps: The detailed steps to implement the functionality, corresponding to the design specification.
- Implementation: Explain how to implement each steps in the previous section with syntactically correct Chisel code..
- Answer: The complete module implementation in a single code block.

Every section is mandatory, omit any section will be considered as an incomplete answer.

# Requirements

- Your thinking process should be comprehensive and well-reasoned, avoid repetitive thinking, keep it concise and informative.
- Your thinking process should not only focus on implementing functionality correct code, but also syntactically correct code. That requires you to think about how to properly use Chisel language features.
- Follow the format and instructions provided in the output section.

# Request

{{ spec }}
